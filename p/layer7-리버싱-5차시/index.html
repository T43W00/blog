<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="수업 내용 정리 IDA란? Interactive DisAssembler의 약자로, 기계어를 어셈블리어로 변환해주는 프로그램이다.\n디컴파일러가 매우 강력하다. 하지만 그만큼 비싸다.\n주요 탭 Function 함수들의 목록을 보여준다. 클릭 시 해당 함수의 주소로 이동할 수 있다.\n보라색은 외부 라이브러리의 함수이고, 나머지는 사용자가 정의한 함수이다.\nGraph view 어셈블리어 코드의 흐름을 그래프로 보여준다. 분기문이 많은 어셈블리어 코드를 볼 때 매우 효과적이다.\nText view 텍스트로만 되어있는 어셈블리어 코드이다. 주소 순으로 섹션과 코드를 볼 수 있어 원하는 값을 찾기에 편리하다.\n"><title>Layer7 리버싱 5차시</title><link rel=canonical href=https://t43w00.netlify.app/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Layer7 리버싱 5차시"><meta property='og:description' content="수업 내용 정리 IDA란? Interactive DisAssembler의 약자로, 기계어를 어셈블리어로 변환해주는 프로그램이다.\n디컴파일러가 매우 강력하다. 하지만 그만큼 비싸다.\n주요 탭 Function 함수들의 목록을 보여준다. 클릭 시 해당 함수의 주소로 이동할 수 있다.\n보라색은 외부 라이브러리의 함수이고, 나머지는 사용자가 정의한 함수이다.\nGraph view 어셈블리어 코드의 흐름을 그래프로 보여준다. 분기문이 많은 어셈블리어 코드를 볼 때 매우 효과적이다.\nText view 텍스트로만 되어있는 어셈블리어 코드이다. 주소 순으로 섹션과 코드를 볼 수 있어 원하는 값을 찾기에 편리하다.\n"><meta property='og:url' content='https://t43w00.netlify.app/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/'><meta property='og:site_name' content='T43W00'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Layer7'><meta property='article:tag' content='Reversing'><meta property='article:published_time' content='2025-06-13T00:00:00+00:00'><meta property='article:modified_time' content='2025-06-13T00:00:00+00:00'><meta name=twitter:title content="Layer7 리버싱 5차시"><meta name=twitter:description content="수업 내용 정리 IDA란? Interactive DisAssembler의 약자로, 기계어를 어셈블리어로 변환해주는 프로그램이다.\n디컴파일러가 매우 강력하다. 하지만 그만큼 비싸다.\n주요 탭 Function 함수들의 목록을 보여준다. 클릭 시 해당 함수의 주소로 이동할 수 있다.\n보라색은 외부 라이브러리의 함수이고, 나머지는 사용자가 정의한 함수이다.\nGraph view 어셈블리어 코드의 흐름을 그래프로 보여준다. 분기문이 많은 어셈블리어 코드를 볼 때 매우 효과적이다.\nText view 텍스트로만 되어있는 어셈블리어 코드이다. 주소 순으로 섹션과 코드를 볼 수 있어 원하는 값을 찾기에 편리하다.\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_da68217e1fd91b15.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🐱</span></figure><div class=site-meta><h1 class=site-name><a href=/>T43W00</a></h1><h2 class=site-description>정보보안 공부</h2></div></header><ol class=menu-social><li><a href=https://github.com/t43w00 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/743w00 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#수업-내용-정리>수업 내용 정리</a><ol><li><a href=#ida란>IDA란?</a><ol><li><a href=#주요-탭>주요 탭</a></li><li><a href=#주요-단축키>주요 단축키</a></li></ol></li><li><a href=#dreamhack-rev-basic-16>Dreamhack rev-basic-1~6</a><ol><li><a href=#rev-basic-1>rev-basic-1</a></li><li><a href=#rev-basic-2>rev-basic-2</a></li><li><a href=#rev-basic-3>rev-basic-3</a></li><li><a href=#rev-basic-4>rev-basic-4</a></li><li><a href=#rev-basic-5>rev-basic-5</a></li><li><a href=#rev-basic-6>rev-basic-6</a></li></ol></li><li><a href=#ctfd-r5>CTFd R5</a><ol><li><a href=#custom-1>Custom 1</a></li><li><a href=#custom-2>Custom 2</a></li><li><a href=#custom-3>Custom 3</a></li><li><a href=#picoctf-file-run1>[PicoCTF] file-run1</a></li><li><a href=#picoctf-file-run2>[PicoCTF] file-run2</a></li><li><a href=#merong>Merong</a></li></ol></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/layer7/>Layer7
</a><a href=/categories/reversing/>Reversing</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/>Layer7 리버싱 5차시</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 13, 2025</time></div></footer></div></header><section class=article-content><h2 id=수업-내용-정리>수업 내용 정리</h2><h3 id=ida란>IDA란?</h3><p>Interactive DisAssembler의 약자로, 기계어를 어셈블리어로 변환해주는 프로그램이다.</p><p>디컴파일러가 매우 강력하다. 하지만 그만큼 비싸다.</p><br><h4 id=주요-탭>주요 탭</h4><h5 id=function>Function</h5><p>함수들의 목록을 보여준다. 클릭 시 해당 함수의 주소로 이동할 수 있다.</p><p>보라색은 외부 라이브러리의 함수이고, 나머지는 사용자가 정의한 함수이다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image.png width=385 height=708 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image_hu_eac23429292aa98e.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image_hu_e629cd10fe984c7f.png 1024w" loading=lazy class=gallery-image data-flex-grow=54 data-flex-basis=130px></p><br><h5 id=graph-view>Graph view</h5><p>어셈블리어 코드의 흐름을 그래프로 보여준다. 분기문이 많은 어셈블리어 코드를 볼 때 매우 효과적이다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-1.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-1_hu_25f2b1a5d7643bc5.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-1_hu_323330f534664257.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><br><h5 id=text-view>Text view</h5><p>텍스트로만 되어있는 어셈블리어 코드이다. 주소 순으로 섹션과 코드를 볼 수 있어 원하는 값을 찾기에 편리하다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-2.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-2_hu_8a1449913241778b.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-2_hu_5ff47c291bca504f.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><br><h5 id=hex-view>Hex view</h5><p>Text view에서 볼 수 있는 어셈블리어 코드를 Hex(16진수)값으로 볼 수 있다. 값을 복사해오거나 오른쪽 아스키로 변환된 값을 참고할 때 자주 쓰인다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-3.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-3_hu_34185e87130df4a8.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-3_hu_63ef9aae6bc98e14.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><br><h4 id=주요-단축키>주요 단축키</h4><h5 id=shift--f12>Shift + F12</h5><p>프로그램 내 문자열들의 정보들을 알려주는 Strings 탭을 열 수 있다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-4.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-4_hu_36b54439676e6d7d.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-4_hu_d0e6fd62cc75df7a.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><br><h5 id=n>N</h5><p>변수나 함수의 이름을 리네임 할 수 있다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-5.png width=662 height=96 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-5_hu_3ac9c2bd1d768254.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-5_hu_41b94051bc822ddb.png 1024w" loading=lazy class=gallery-image data-flex-grow=689 data-flex-basis=1655px></p><br><h5 id=y>Y</h5><p>함수의 프로토타입을 수정할 수 있다. 함수나 매개변수의 이름을 바꾸거나 자료형을 바꿀 때 사용된다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-6.png width=802 height=192 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-6_hu_d39617994090438.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-6_hu_6cd199274f9872f4.png 1024w" loading=lazy class=gallery-image data-flex-grow=417 data-flex-basis=1002px></p><br><hr><br><h3 id=dreamhack-rev-basic-16>Dreamhack rev-basic-1~6</h3><h4 id=rev-basic-1>rev-basic-1</h4><p>실행을 해보니 입력을 받고 판별 후 결과를 출력하는 것으로 보인다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-7.png width=466 height=172 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-7_hu_5dcde0b256bca51f.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-7_hu_6762887f0b62abe1.png 1024w" loading=lazy class=gallery-image data-flex-grow=270 data-flex-basis=650px></p><br><p>분석을 위해 IDA로 프로그램을 열어보았다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-8.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-8_hu_2a73be097efb70ec.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-8_hu_92bbc54244fa4d18.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><br><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-s data-lang=s><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rcx</span><span class=p>,</span> <span class=n>aInput</span>     <span class=p>;</span> <span class=s>&#34;Input : &#34;</span>
</span></span><span class=line><span class=cl><span class=n>call</span>    <span class=n>sub_1400013E0</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rdx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+138</span><span class=n>h</span><span class=o>+</span><span class=n>var_118]</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rcx</span><span class=p>,</span> <span class=n>a256s</span>      <span class=p>;</span> <span class=s>&#34;%256s&#34;</span>
</span></span><span class=line><span class=cl><span class=n>call</span>    <span class=n>sub_140001440</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+138</span><span class=n>h</span><span class=o>+</span><span class=n>var_118]</span>
</span></span><span class=line><span class=cl><span class=n>call</span>    <span class=n>sub_140001000</span>
</span></span><span class=line><span class=cl><span class=n>test</span>    <span class=n>eax</span><span class=p>,</span> <span class=n>eax</span>
</span></span><span class=line><span class=cl><span class=n>jz</span>      <span class=n>short</span> <span class=n>loc_1400013B6</span>
</span></span></code></pre></td></tr></table></div></div><p>위 코드를 보면, 사용자에게 <code>[rsp+138h+var_118]</code>에 입력을 받고, 이를 인자로 <code>sub_140001000</code> 함수를 호출하여 그 값이 <code>0</code>인지 아닌지에 따라 분기하는 것을 확인할 수 있다.</p><br><p><code>sub_140001000</code> 함수를 확인해보았다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-9.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-9_hu_910076865a5ab516.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-9_hu_a036dbf5daf0494e.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-10.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-10_hu_4ae0a8433b1ccab5.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-10_hu_577bef7d73c14f63.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>같은 구조의 여러 코드가 있고, 끝까지 조건에 맞게 분기하면 <code>1</code>을 반환하고 아닌 경우에는 <code>0</code>을 반환하도록 되어있다.</p><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-11.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-11_hu_35b1e3109efc075f.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-11_hu_ac49ba15bf4848e8.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>첫 블럭부터 네 번째 블럭까지 확인해보니, <code>n</code>번째 블럭에서 인자의 <code>n</code>번째 인덱스 값을 특정 문자와 비교하여 같은 경우에 분기하는 것을 확인할 수 있다.</p><br><p>첫 번째 블럭부터 마지막 블럭까지 각각 비교하는 문자를 조합하면 전체 문자열이 나온다.</p><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-12.png width=1920 height=1200 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-12_hu_58131b3051fad09f.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-12_hu_ed4e9696ec136f85.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><br><h4 id=rev-basic-2>rev-basic-2</h4><p>전 문제와 똑같이 입력값을 검증하는 프로그램이므로 입력값을 검증하는 함수만 분석하도록 하겠다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-13.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-13_hu_2bbe276d905e4843.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-13_hu_8cb7e01b05ed9f13.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><br><p>코드를 보면 <code>[rsp+18h+var_18]</code>이 <code>12</code>가 될 때까지 <code>rax</code>를 카운터로 <code>1</code>씩 증가시키며 <code>aC[rax * 4]</code>와 입력받은 문자열의 인덱스를 비교하여 같은지 비교하는 것을 알 수 있다.</p><br><p>따라서 <code>aC</code> 배열의 4의 배수 인덱스에 해당하는 값을 가져와 조합하면 알맞은 입력값을 알아낼 수 있다.</p><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-14.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-14_hu_c7c405bb1f68ed4e.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-14_hu_5fd0c486a98a1e8c.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-15.png width=1920 height=1200 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-15_hu_b266cab1b73c3f99.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-15_hu_31cb1e32f336cc27.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><br><h4 id=rev-basic-3>rev-basic-3</h4><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-16.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-16_hu_4a97cbfb4a1ba58f.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-16_hu_c36399055206189b.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>전 문제와 똑같이 <code>rax</code>를 카운터로 사용하고 <code>18</code>이 될 때까지 특정 연산 후에 비교하는 것을 확인할 수 있다.</p><br><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-s data-lang=s><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rax</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rax</span> <span class=o>=</span> <span class=nf>i </span><span class=p>(</span>카운터로 사용<span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rcx</span><span class=p>,</span> <span class=n>byte_140003000</span>     <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=o>*</span><span class=n>bytes</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>eax</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rcx</span><span class=o>+</span><span class=n>rax]</span> <span class=p>;</span> <span class=n>eax</span> <span class=o>=</span> <span class=n>bytes[i]</span>
</span></span><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>mov</span>     <span class=n>rdx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>arg_0]</span>    <span class=p>;</span> <span class=n>rdx</span> <span class=o>=</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>ecx</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rdx</span><span class=o>+</span><span class=n>rcx]</span> <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>input[i]</span>
</span></span><span class=line><span class=cl><span class=n>xor</span>     <span class=n>ecx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>input[i]</span> <span class=n>^</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>mov</span>     <span class=n>edx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>edx</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>ecx</span><span class=p>,</span> <span class=n>[rcx</span><span class=o>+</span><span class=n>rdx</span><span class=o>*</span><span class=m>2</span><span class=n>]</span>        <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>input[i]</span> <span class=n>^</span> <span class=n>i</span> <span class=o>+</span> <span class=n>i</span> <span class=o>*</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=n>cmp</span>     <span class=n>eax</span><span class=p>,</span> <span class=n>ecx</span>                <span class=p>;</span> <span class=n>bytes[i]</span> <span class=o>-</span> <span class=p>(</span><span class=n>input[i]</span> <span class=n>^</span> <span class=n>i</span> <span class=o>+</span> <span class=n>i</span> <span class=o>*</span> <span class=m>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>jz</span>      <span class=n>short</span> <span class=n>loc_140001051</span>     
</span></span></code></pre></td></tr></table></div></div><p><code>bytes[i]</code>와 <code>input[i] ^ i + i * 2</code>를 비교하여 같으면 <code>inc eax</code> 후에 계속 반복하고, 다르다면 <code>0</code>을 반환시킨다. <code>[rsp+18h+var_18]</code>가 <code>0x18</code>이 될 때까지 두 값이 같으면 <code>1</code>을 반환한다.</p><p>따라서 식을 정리하여 <code>input[i]</code>의 값을 구하면 될 것 같다.</p><br><p><code>bytes[i] = input[i] ^ i + i * 2</code> 식을 <code>input[i]</code> 항만 남기고 나머지를 이항하면 <code>input[i] = (bytes[i] - i * 2) ^ i</code>와 같이 나타낼 수 있다. 따라서 <code>(bytes[i] - i * 2) ^ i</code> 값에 <code>i</code>를 <code>0</code>부터 <code>0x18</code>까지 대입하여 출력하면 올바른 입력값이 출력될 것이다.</p><br><p>C++을 이용해 입력값을 구하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>bytes</span><span class=p>[</span><span class=mh>0x18</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x49</span><span class=p>,</span> <span class=mh>0x60</span><span class=p>,</span> <span class=mh>0x67</span><span class=p>,</span> <span class=mh>0x74</span><span class=p>,</span> <span class=mh>0x63</span><span class=p>,</span> <span class=mh>0x67</span><span class=p>,</span> <span class=mh>0x42</span><span class=p>,</span> <span class=mh>0x66</span><span class=p>,</span> <span class=mh>0x80</span><span class=p>,</span> <span class=mh>0x78</span><span class=p>,</span> <span class=mh>0x69</span><span class=p>,</span> <span class=mh>0x69</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x7B</span><span class=p>,</span> <span class=mh>0x99</span><span class=p>,</span> <span class=mh>0x6D</span><span class=p>,</span> <span class=mh>0x88</span><span class=p>,</span> <span class=mh>0x68</span><span class=p>,</span> <span class=mh>0x94</span><span class=p>,</span> <span class=mh>0x9F</span><span class=p>,</span> <span class=mh>0x8D</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0xA5</span><span class=p>,</span> <span class=mh>0x9D</span><span class=p>,</span> <span class=mh>0x45</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mh>0x18</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>bytes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>i</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=o>^</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-17.png width=1920 height=1200 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-17_hu_5cdcb50b9ad0d152.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-17_hu_c9d7c64b6db6384a.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><br><h4 id=rev-basic-4>rev-basic-4</h4><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-18.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-18_hu_ec48a07d10a0d7f9.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-18_hu_6edfca995f7498c7.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>이전 문제들과 같은 구조이기 때문에 값을 비교하는 부분만 분석하도록 하겠다.</p><br><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-s data-lang=s><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rax</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rax</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>mov</span>     <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>arg_0]</span>    <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>eax</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rcx</span><span class=o>+</span><span class=n>rax]</span> <span class=p>;</span> <span class=n>eax</span> <span class=o>=</span> <span class=n>input[i]</span>
</span></span><span class=line><span class=cl><span class=n>sar</span>     <span class=n>eax</span><span class=p>,</span> <span class=m>4</span>                  <span class=p>;</span> <span class=n>eax</span> <span class=o>=</span> <span class=n>input[i]</span> <span class=o>&gt;&gt;</span> <span class=m>4</span>
</span></span><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>mov</span>     <span class=n>rdx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>arg_0]</span>    <span class=p>;</span> <span class=n>rdx</span> <span class=o>=</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>ecx</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rdx</span><span class=o>+</span><span class=n>rcx]</span> <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>input[i]</span>
</span></span><span class=line><span class=cl><span class=n>shl</span>     <span class=n>ecx</span><span class=p>,</span> <span class=m>4</span>                  <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>input[i]</span> <span class=o>&lt;&lt;</span> <span class=m>4</span>
</span></span><span class=line><span class=cl><span class=n>and</span>     <span class=n>ecx</span><span class=p>,</span> <span class=m>0</span><span class=n>F0h</span>               <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>ecx</span> <span class=o>&amp;</span> <span class=mh>0xF0</span>
</span></span><span class=line><span class=cl><span class=n>or</span>      <span class=n>eax</span><span class=p>,</span> <span class=n>ecx</span>                <span class=p>;</span> <span class=n>eax</span> <span class=o>=</span> <span class=p>(</span><span class=n>input[i]</span> <span class=o>&gt;&gt;</span> <span class=m>4</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>input</span> <span class=o>&lt;&lt;</span> <span class=m>4</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rdx</span><span class=p>,</span> <span class=n>unk_140003000</span>      <span class=p>;</span> <span class=n>rdx</span> <span class=o>=</span> <span class=n>bytes</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>ecx</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rdx</span><span class=o>+</span><span class=n>rcx]</span> <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>bytes[i]</span>
</span></span><span class=line><span class=cl><span class=n>cmp</span>     <span class=n>eax</span><span class=p>,</span> <span class=n>ecx</span>                <span class=p>;</span> <span class=p>(</span><span class=n>input[i]</span> <span class=o>&gt;&gt;</span> <span class=m>4</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>input[i]</span> <span class=o>&lt;&lt;</span> <span class=m>4</span><span class=p>)</span> <span class=o>-</span> <span class=n>bytes[i]</span>
</span></span><span class=line><span class=cl><span class=n>jz</span>      <span class=n>short</span> <span class=n>loc_140001063</span>
</span></span></code></pre></td></tr></table></div></div><p><code>(input[i] >> 4) | (input[i] &lt;&lt; 4)</code> 식은 <code>input[i]</code>의 상위 4비트와 하위 4비트를 서로 바꾸는 연산이다. 따라서 이 값이 <code>bytes[i]</code>와 같으니 원래 값인 <code>input[i]</code>를 구하려면 <code>bytes[i]</code>의 상위 4비트와 하위 4비트 값을 바꿔주면 된다.</p><br><p>C++을 이용해 입력값을 구하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>bytes</span><span class=p>[</span><span class=mh>0x1C</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x24</span><span class=p>,</span> <span class=mh>0x27</span><span class=p>,</span> <span class=mh>0x13</span><span class=p>,</span> <span class=mh>0xC6</span><span class=p>,</span> <span class=mh>0xC6</span><span class=p>,</span> <span class=mh>0x13</span><span class=p>,</span> <span class=mh>0x16</span><span class=p>,</span> <span class=mh>0xE6</span><span class=p>,</span> <span class=mh>0x47</span><span class=p>,</span> <span class=mh>0xF5</span><span class=p>,</span> <span class=mh>0x26</span><span class=p>,</span> <span class=mh>0x96</span><span class=p>,</span> <span class=mh>0x47</span><span class=p>,</span> <span class=mh>0xF5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x46</span><span class=p>,</span> <span class=mh>0x27</span><span class=p>,</span> <span class=mh>0x13</span><span class=p>,</span> <span class=mh>0x26</span><span class=p>,</span> <span class=mh>0x26</span><span class=p>,</span> <span class=mh>0xC6</span><span class=p>,</span> <span class=mh>0x56</span><span class=p>,</span> <span class=mh>0xF5</span><span class=p>,</span> <span class=mh>0xC3</span><span class=p>,</span> <span class=mh>0xC3</span><span class=p>,</span> <span class=mh>0xF5</span><span class=p>,</span> <span class=mh>0xE3</span><span class=p>,</span> <span class=mh>0xE3</span><span class=p>,</span> <span class=mh>0x00</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mh>0x1C</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>bytes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>bytes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-19.png width=1920 height=1200 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-19_hu_52abcb61bc388ce.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-19_hu_664b89b2acf6cef6.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><br><h4 id=rev-basic-5>rev-basic-5</h4><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-20.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-20_hu_bfd63b2403903916.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-20_hu_603650ca7ddf33ee.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-s data-lang=s><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rax</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rax</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>mov</span>     <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>arg_0]</span>    <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>eax</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rcx</span><span class=o>+</span><span class=n>rax]</span> <span class=p>;</span> <span class=n>eax</span> <span class=o>=</span> <span class=n>input[i]</span>
</span></span><span class=line><span class=cl><span class=n>mov</span>     <span class=n>ecx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>inc</span>     <span class=n>ecx</span>                     <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rcx</span><span class=p>,</span> <span class=n>ecx</span>                <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=n>mov</span>     <span class=n>rdx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>arg_0]</span>    <span class=p>;</span> <span class=n>rdx</span> <span class=o>=</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>ecx</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rdx</span><span class=o>+</span><span class=n>rcx]</span> <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>input[i</span> <span class=o>+</span> <span class=m>1</span><span class=n>]</span>
</span></span><span class=line><span class=cl><span class=n>add</span>     <span class=n>eax</span><span class=p>,</span> <span class=n>ecx</span>                <span class=p>;</span> <span class=n>eax</span> <span class=o>=</span> <span class=n>input[i]</span> <span class=o>+</span> <span class=n>input[i</span> <span class=o>+</span> <span class=m>1</span><span class=n>]</span>
</span></span><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rdx</span><span class=p>,</span> <span class=n>unk_140003000</span>      <span class=p>;</span> <span class=n>rdx</span> <span class=o>=</span> <span class=n>bytes</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>ecx</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rdx</span><span class=o>+</span><span class=n>rcx]</span> <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>bytes[i]</span>
</span></span><span class=line><span class=cl><span class=n>cmp</span>     <span class=n>eax</span><span class=p>,</span> <span class=n>ecx</span>                <span class=p>;</span> <span class=p>(</span><span class=n>input[i]</span> <span class=o>+</span> <span class=n>input[i</span> <span class=o>+</span> <span class=m>1</span><span class=n>]</span><span class=p>)</span> <span class=o>-</span> <span class=n>bytes[i]</span>
</span></span><span class=line><span class=cl><span class=n>jz</span>      <span class=n>short</span> <span class=n>loc_14000105B</span>
</span></span></code></pre></td></tr></table></div></div><p><code>input[i] + input[i + 1]</code>의 연산 결과가 <code>bytes[i]</code>와 같아야 한다. 하지만 <code>input[i]</code>를 구하려면 <code>input[i+1]</code>을 구해야 해서 단순히 역연산으로 동시에 구하는 것은 불가능하다.</p><p><code>bytes</code>에 해당하는 <code>unk_140003000</code>의 값을 확인해보면 아래와 같다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>AD D8 CB CB 9D 97 CB C4  92 A1 D2 D7 D2 D6 A8 A5
</span></span><span class=line><span class=cl>DC C7 AD A3 A1 98 4C 00  
</span></span></code></pre></td></tr></table></div></div><p>여기서 마지막 값이 널 문자인 것을 확인할 수 있는데, 이를 통해 <code>input</code> 배열의 마지막 값이 <code>4C - 0</code>으로 <code>4C</code>인 것을 알 수 있다. 따라서 마지막 값의 바로 전 값도 같은 방식으로 구할 수 있고, 이를 통해 전체 문자열을 거꾸로 한 문자씩 구할 수 있다.</p><br><p>C++을 이용해 입력값을 구하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>bytes</span><span class=p>[</span><span class=mh>0x18</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0xD8</span><span class=p>,</span> <span class=mh>0xCB</span><span class=p>,</span> <span class=mh>0xCB</span><span class=p>,</span> <span class=mh>0x9D</span><span class=p>,</span> <span class=mh>0x97</span><span class=p>,</span> <span class=mh>0xCB</span><span class=p>,</span> <span class=mh>0xC4</span><span class=p>,</span> <span class=mh>0x92</span><span class=p>,</span> <span class=mh>0xA1</span><span class=p>,</span> <span class=mh>0xD2</span><span class=p>,</span> <span class=mh>0xD7</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xD2</span><span class=p>,</span> <span class=mh>0xD6</span><span class=p>,</span> <span class=mh>0xA8</span><span class=p>,</span> <span class=mh>0xA5</span><span class=p>,</span> <span class=mh>0xDC</span><span class=p>,</span> <span class=mh>0xC7</span><span class=p>,</span> <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0xA3</span><span class=p>,</span> <span class=mh>0xA1</span><span class=p>,</span> <span class=mh>0x98</span><span class=p>,</span> <span class=mh>0x4C</span><span class=p>,</span> <span class=mh>0x00</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>res</span><span class=p>[</span><span class=mh>0x19</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mh>0x17</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>bytes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span> <span class=mh>0x18</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-21.png width=1920 height=1200 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-21_hu_37a7fb8024f625d7.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-21_hu_fa5c7376cbac7157.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><br><h4 id=rev-basic-6>rev-basic-6</h4><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-22.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-22_hu_64e27cb6879f3715.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-22_hu_86a4119081756e3d.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-s data-lang=s><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rax</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rax</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>mov</span>     <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>arg_0]</span>    <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>eax</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rcx</span><span class=o>+</span><span class=n>rax]</span> <span class=p>;</span> <span class=n>eax</span> <span class=o>=</span> <span class=n>input[i]</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rcx</span><span class=p>,</span> <span class=n>unk_140003020</span>      <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>table</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>eax</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rcx</span><span class=o>+</span><span class=n>rax]</span> <span class=p>;</span> <span class=n>eax</span> <span class=o>=</span> <span class=n>table[input[i]]</span>
</span></span><span class=line><span class=cl><span class=n>movsxd</span>  <span class=n>rcx</span><span class=p>,</span> <span class=n>[rsp</span><span class=m>+18</span><span class=n>h</span><span class=o>+</span><span class=n>var_18]</span>   <span class=p>;</span> <span class=n>rcx</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>lea</span>     <span class=n>rdx</span><span class=p>,</span> <span class=n>unk_140003000</span>      <span class=p>;</span> <span class=n>rdx</span> <span class=o>=</span> <span class=n>bytes</span>
</span></span><span class=line><span class=cl><span class=n>movzx</span>   <span class=n>ecx</span><span class=p>,</span> <span class=n>byte</span> <span class=n>ptr</span> <span class=n>[rdx</span><span class=o>+</span><span class=n>rcx]</span> <span class=p>;</span> <span class=n>ecx</span> <span class=o>=</span> <span class=n>bytes[i]</span>
</span></span><span class=line><span class=cl><span class=n>cmp</span>     <span class=n>eax</span><span class=p>,</span> <span class=n>ecx</span>                <span class=p>;</span> <span class=n>table[input[i]]</span> <span class=o>-</span> <span class=n>bytes[i]</span>
</span></span><span class=line><span class=cl><span class=n>jz</span>      <span class=n>short</span> <span class=n>loc_140001053</span>
</span></span></code></pre></td></tr></table></div></div><p>따라서 <code>table</code> 배열에서 <code>bytes[i]</code>과 같은 값의 인덱스가 <code>input[i]</code>인 것이다.</p><br><p>C++을 이용해 입력값을 구하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>bytes</span><span class=p>[</span><span class=mh>0x12</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0x51</span><span class=p>,</span> <span class=mh>0x50</span><span class=p>,</span> <span class=mh>0xEF</span><span class=p>,</span> <span class=mh>0xFB</span><span class=p>,</span> <span class=mh>0xC3</span><span class=p>,</span> <span class=mh>0xCF</span><span class=p>,</span> <span class=mh>0x92</span><span class=p>,</span> <span class=mh>0x45</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0xCF</span><span class=p>,</span> <span class=mh>0xF5</span><span class=p>,</span> <span class=mh>0x04</span><span class=p>,</span> <span class=mh>0x40</span><span class=p>,</span> <span class=mh>0x50</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x43</span><span class=p>,</span> <span class=mh>0x63</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>table</span><span class=p>[</span><span class=mh>0x100</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x63</span><span class=p>,</span> <span class=mh>0x7C</span><span class=p>,</span> <span class=mh>0x77</span><span class=p>,</span> <span class=mh>0x7B</span><span class=p>,</span> <span class=mh>0xF2</span><span class=p>,</span> <span class=mh>0x6B</span><span class=p>,</span> <span class=mh>0x6F</span><span class=p>,</span> <span class=mh>0xC5</span><span class=p>,</span> <span class=mh>0x30</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x67</span><span class=p>,</span> <span class=mh>0x2B</span><span class=p>,</span> <span class=mh>0xFE</span><span class=p>,</span> <span class=mh>0xD7</span><span class=p>,</span> <span class=mh>0xAB</span><span class=p>,</span> <span class=mh>0x76</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xCA</span><span class=p>,</span> <span class=mh>0x82</span><span class=p>,</span> <span class=mh>0xC9</span><span class=p>,</span> <span class=mh>0x7D</span><span class=p>,</span> <span class=mh>0xFA</span><span class=p>,</span> <span class=mh>0x59</span><span class=p>,</span> <span class=mh>0x47</span><span class=p>,</span> <span class=mh>0xF0</span><span class=p>,</span> <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0xD4</span><span class=p>,</span> <span class=mh>0xA2</span><span class=p>,</span> <span class=mh>0xAF</span><span class=p>,</span> <span class=mh>0x9C</span><span class=p>,</span> <span class=mh>0xA4</span><span class=p>,</span> <span class=mh>0x72</span><span class=p>,</span> <span class=mh>0xC0</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xB7</span><span class=p>,</span> <span class=mh>0xFD</span><span class=p>,</span> <span class=mh>0x93</span><span class=p>,</span> <span class=mh>0x26</span><span class=p>,</span> <span class=mh>0x36</span><span class=p>,</span> <span class=mh>0x3F</span><span class=p>,</span> <span class=mh>0xF7</span><span class=p>,</span> <span class=mh>0xCC</span><span class=p>,</span> <span class=mh>0x34</span><span class=p>,</span> <span class=mh>0xA5</span><span class=p>,</span> <span class=mh>0xE5</span><span class=p>,</span> <span class=mh>0xF1</span><span class=p>,</span> <span class=mh>0x71</span><span class=p>,</span> <span class=mh>0xD8</span><span class=p>,</span> <span class=mh>0x31</span><span class=p>,</span> <span class=mh>0x15</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x04</span><span class=p>,</span> <span class=mh>0xC7</span><span class=p>,</span> <span class=mh>0x23</span><span class=p>,</span> <span class=mh>0xC3</span><span class=p>,</span> <span class=mh>0x18</span><span class=p>,</span> <span class=mh>0x96</span><span class=p>,</span> <span class=mh>0x05</span><span class=p>,</span> <span class=mh>0x9A</span><span class=p>,</span> <span class=mh>0x07</span><span class=p>,</span> <span class=mh>0x12</span><span class=p>,</span> <span class=mh>0x80</span><span class=p>,</span> <span class=mh>0xE2</span><span class=p>,</span> <span class=mh>0xEB</span><span class=p>,</span> <span class=mh>0x27</span><span class=p>,</span> <span class=mh>0xB2</span><span class=p>,</span> <span class=mh>0x75</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x09</span><span class=p>,</span> <span class=mh>0x83</span><span class=p>,</span> <span class=mh>0x2C</span><span class=p>,</span> <span class=mh>0x1A</span><span class=p>,</span> <span class=mh>0x1B</span><span class=p>,</span> <span class=mh>0x6E</span><span class=p>,</span> <span class=mh>0x5A</span><span class=p>,</span> <span class=mh>0xA0</span><span class=p>,</span> <span class=mh>0x52</span><span class=p>,</span> <span class=mh>0x3B</span><span class=p>,</span> <span class=mh>0xD6</span><span class=p>,</span> <span class=mh>0xB3</span><span class=p>,</span> <span class=mh>0x29</span><span class=p>,</span> <span class=mh>0xE3</span><span class=p>,</span> <span class=mh>0x2F</span><span class=p>,</span> <span class=mh>0x84</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x53</span><span class=p>,</span> <span class=mh>0xD1</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xED</span><span class=p>,</span> <span class=mh>0x20</span><span class=p>,</span> <span class=mh>0xFC</span><span class=p>,</span> <span class=mh>0xB1</span><span class=p>,</span> <span class=mh>0x5B</span><span class=p>,</span> <span class=mh>0x6A</span><span class=p>,</span> <span class=mh>0xCB</span><span class=p>,</span> <span class=mh>0xBE</span><span class=p>,</span> <span class=mh>0x39</span><span class=p>,</span> <span class=mh>0x4A</span><span class=p>,</span> <span class=mh>0x4C</span><span class=p>,</span> <span class=mh>0x58</span><span class=p>,</span> <span class=mh>0xCF</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xD0</span><span class=p>,</span> <span class=mh>0xEF</span><span class=p>,</span> <span class=mh>0xAA</span><span class=p>,</span> <span class=mh>0xFB</span><span class=p>,</span> <span class=mh>0x43</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x85</span><span class=p>,</span> <span class=mh>0x45</span><span class=p>,</span> <span class=mh>0xF9</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x7F</span><span class=p>,</span> <span class=mh>0x50</span><span class=p>,</span> <span class=mh>0x3C</span><span class=p>,</span> <span class=mh>0x9F</span><span class=p>,</span> <span class=mh>0xA8</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x51</span><span class=p>,</span> <span class=mh>0xA3</span><span class=p>,</span> <span class=mh>0x40</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0x92</span><span class=p>,</span> <span class=mh>0x9D</span><span class=p>,</span> <span class=mh>0x38</span><span class=p>,</span> <span class=mh>0xF5</span><span class=p>,</span> <span class=mh>0xBC</span><span class=p>,</span> <span class=mh>0xB6</span><span class=p>,</span> <span class=mh>0xDA</span><span class=p>,</span> <span class=mh>0x21</span><span class=p>,</span> <span class=mh>0x10</span><span class=p>,</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=mh>0xF3</span><span class=p>,</span> <span class=mh>0xD2</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xCD</span><span class=p>,</span> <span class=mh>0x0C</span><span class=p>,</span> <span class=mh>0x13</span><span class=p>,</span> <span class=mh>0xEC</span><span class=p>,</span> <span class=mh>0x5F</span><span class=p>,</span> <span class=mh>0x97</span><span class=p>,</span> <span class=mh>0x44</span><span class=p>,</span> <span class=mh>0x17</span><span class=p>,</span> <span class=mh>0xC4</span><span class=p>,</span> <span class=mh>0xA7</span><span class=p>,</span> <span class=mh>0x7E</span><span class=p>,</span> <span class=mh>0x3D</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>,</span> <span class=mh>0x5D</span><span class=p>,</span> <span class=mh>0x19</span><span class=p>,</span> <span class=mh>0x73</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x60</span><span class=p>,</span> <span class=mh>0x81</span><span class=p>,</span> <span class=mh>0x4F</span><span class=p>,</span> <span class=mh>0xDC</span><span class=p>,</span> <span class=mh>0x22</span><span class=p>,</span> <span class=mh>0x2A</span><span class=p>,</span> <span class=mh>0x90</span><span class=p>,</span> <span class=mh>0x88</span><span class=p>,</span> <span class=mh>0x46</span><span class=p>,</span> <span class=mh>0xEE</span><span class=p>,</span> <span class=mh>0xB8</span><span class=p>,</span> <span class=mh>0x14</span><span class=p>,</span> <span class=mh>0xDE</span><span class=p>,</span> <span class=mh>0x5E</span><span class=p>,</span> <span class=mh>0x0B</span><span class=p>,</span> <span class=mh>0xDB</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xE0</span><span class=p>,</span> <span class=mh>0x32</span><span class=p>,</span> <span class=mh>0x3A</span><span class=p>,</span> <span class=mh>0x0A</span><span class=p>,</span> <span class=mh>0x49</span><span class=p>,</span> <span class=mh>0x06</span><span class=p>,</span> <span class=mh>0x24</span><span class=p>,</span> <span class=mh>0x5C</span><span class=p>,</span> <span class=mh>0xC2</span><span class=p>,</span> <span class=mh>0xD3</span><span class=p>,</span> <span class=mh>0xAC</span><span class=p>,</span> <span class=mh>0x62</span><span class=p>,</span> <span class=mh>0x91</span><span class=p>,</span> <span class=mh>0x95</span><span class=p>,</span> <span class=mh>0xE4</span><span class=p>,</span> <span class=mh>0x79</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xE7</span><span class=p>,</span> <span class=mh>0xC8</span><span class=p>,</span> <span class=mh>0x37</span><span class=p>,</span> <span class=mh>0x6D</span><span class=p>,</span> <span class=mh>0x8D</span><span class=p>,</span> <span class=mh>0xD5</span><span class=p>,</span> <span class=mh>0x4E</span><span class=p>,</span> <span class=mh>0xA9</span><span class=p>,</span> <span class=mh>0x6C</span><span class=p>,</span> <span class=mh>0x56</span><span class=p>,</span> <span class=mh>0xF4</span><span class=p>,</span> <span class=mh>0xEA</span><span class=p>,</span> <span class=mh>0x65</span><span class=p>,</span> <span class=mh>0x7A</span><span class=p>,</span> <span class=mh>0xAE</span><span class=p>,</span> <span class=mh>0x08</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xBA</span><span class=p>,</span> <span class=mh>0x78</span><span class=p>,</span> <span class=mh>0x25</span><span class=p>,</span> <span class=mh>0x2E</span><span class=p>,</span> <span class=mh>0x1C</span><span class=p>,</span> <span class=mh>0xA6</span><span class=p>,</span> <span class=mh>0xB4</span><span class=p>,</span> <span class=mh>0xC6</span><span class=p>,</span> <span class=mh>0xE8</span><span class=p>,</span> <span class=mh>0xDD</span><span class=p>,</span> <span class=mh>0x74</span><span class=p>,</span> <span class=mh>0x1F</span><span class=p>,</span> <span class=mh>0x4B</span><span class=p>,</span> <span class=mh>0xBD</span><span class=p>,</span> <span class=mh>0x8B</span><span class=p>,</span> <span class=mh>0x8A</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x70</span><span class=p>,</span> <span class=mh>0x3E</span><span class=p>,</span> <span class=mh>0xB5</span><span class=p>,</span> <span class=mh>0x66</span><span class=p>,</span> <span class=mh>0x48</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>,</span> <span class=mh>0xF6</span><span class=p>,</span> <span class=mh>0x0E</span><span class=p>,</span> <span class=mh>0x61</span><span class=p>,</span> <span class=mh>0x35</span><span class=p>,</span> <span class=mh>0x57</span><span class=p>,</span> <span class=mh>0xB9</span><span class=p>,</span> <span class=mh>0x86</span><span class=p>,</span> <span class=mh>0xC1</span><span class=p>,</span> <span class=mh>0x1D</span><span class=p>,</span> <span class=mh>0x9E</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xE1</span><span class=p>,</span> <span class=mh>0xF8</span><span class=p>,</span> <span class=mh>0x98</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x69</span><span class=p>,</span> <span class=mh>0xD9</span><span class=p>,</span> <span class=mh>0x8E</span><span class=p>,</span> <span class=mh>0x94</span><span class=p>,</span> <span class=mh>0x9B</span><span class=p>,</span> <span class=mh>0x1E</span><span class=p>,</span> <span class=mh>0x87</span><span class=p>,</span> <span class=mh>0xE9</span><span class=p>,</span> <span class=mh>0xCE</span><span class=p>,</span> <span class=mh>0x55</span><span class=p>,</span> <span class=mh>0x28</span><span class=p>,</span> <span class=mh>0xDF</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x8C</span><span class=p>,</span> <span class=mh>0xA1</span><span class=p>,</span> <span class=mh>0x89</span><span class=p>,</span> <span class=mh>0x0D</span><span class=p>,</span> <span class=mh>0xBF</span><span class=p>,</span> <span class=mh>0xE6</span><span class=p>,</span> <span class=mh>0x42</span><span class=p>,</span> <span class=mh>0x68</span><span class=p>,</span> <span class=mh>0x41</span><span class=p>,</span> <span class=mh>0x99</span><span class=p>,</span> <span class=mh>0x2D</span><span class=p>,</span> <span class=mh>0x0F</span><span class=p>,</span> <span class=mh>0xB0</span><span class=p>,</span> <span class=mh>0x54</span><span class=p>,</span> <span class=mh>0xBB</span><span class=p>,</span> <span class=mh>0x16</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mh>0x12</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mh>0x90</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>bytes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-23.png width=1920 height=1200 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-23_hu_3dd5ddffff3caf75.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-23_hu_afb518c19a970344.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><br><hr><br><h3 id=ctfd-r5>CTFd R5</h3><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-31.png width=1920 height=1200 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-31_hu_ee0e5767f723da62.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-31_hu_b5c35a9b8115c7ae.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><br><h4 id=custom-1>Custom 1</h4><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-24.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-24_hu_5c4d58da8b0d6c40.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-24_hu_9698efe264513775.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>입력받은 문자열과 <code>s2</code> 문자열을 비교하여 같으면 <code>Correct</code>를 출력한다. 따라서 <code>s2</code> 문자열이 플래그가 되는데, <code>s2</code>의 문자열은 <code>HIBYTE(v5) ^ *((_BYTE *)v10 + i)</code>와 같다.</p><p>여기서 <code>HIBYTE(v5)</code>의 값은 <code>66</code>이고, <code>v10</code>과 <code>s2</code>의 크기가 다른데, <code>v10[32]</code>는 <code>v11</code>과 같다.</p><br><p>C++을 이용해 입력값을 구하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kt>long</span> <span class=kt>long</span> <span class=n>v10</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>v10</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x31397530273B230ELL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v10</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x292B2E1D27302336LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v10</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x2B2A213623351D27LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>v10</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x31302336311D252CLL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>v11</span> <span class=o>=</span> <span class=mi>63</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>ptr</span> <span class=o>=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=n>v10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>32</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>66</span> <span class=o>^</span> <span class=n>ptr</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;</span><span class=p>(</span><span class=mi>66</span> <span class=o>^</span> <span class=n>v11</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><h4 id=custom-2>Custom 2</h4><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-25.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-25_hu_b1a8f1f7106fa931.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-25_hu_8245cfc8b7be0444.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p><code>check2</code> 함수의 반환값이 <code>1</code>이 되도록 하는 입력값 <code>v5</code>가 플래그인 것 같다.</p><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-26.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-26_hu_8b4fb6d8850f5d53.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-26_hu_48c4b6e7d98ea99d.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p><code>check2</code> 함수를 확인해보면 인자인 <code>a1</code>에 특정 연산을 거쳐 <code>v3</code>의 값과 비교하여 검증하는 것으로 보인다.</p><p><code>(unsigned __int8)rol(*(unsigned __int8 *)(i + a1), (unsigned int)(i % 8 + 1)) + 5 != *((_BYTE *)v3 + i)</code> 식을 정리해보면 <code>rol(a1[i], i % 8 + 1) + 5 != v3[i]</code>와 같다.</p><br><p>따라서 <code>a1[i]</code>은 과 같다.</p><p><code>rol</code> 함수는 첫 번째 인자의 값을 두 번째 인자의 값만큼 왼쪽으로 비트 쉬프트 연산을 하고, 잘린 값이 오른쪽으로 다시 돌아오는 비트 순환 연산이다. 이를 반대로 하는 <code>ror</code> 함수를 구현하여 역연산을 할 수 있다.</p><br><p>C++을 이용해 입력값을 구하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>ror</span> <span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=n>n</span><span class=p>)</span> <span class=o>|</span> <span class=p>((</span><span class=n>x</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=mi>8</span> <span class=o>-</span> <span class=n>n</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>long</span> <span class=kt>long</span> <span class=n>v3</span><span class=p>[</span><span class=mi>7</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x59C2D2535BD08A9DLL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x66B85AB29AAE1EB3LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x661D95343B784AB5LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x661E53ED2B405A93LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x4EBF20ED9978D9B3LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x5FB857104BB8B695LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>v3</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0x82A354F33B68B6B5LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>ptr</span> <span class=o>=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=n>v3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>56</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;</span><span class=p>(</span><span class=n>ror</span><span class=p>(</span><span class=n>ptr</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=mi>5</span><span class=p>,</span> <span class=n>i</span> <span class=o>%</span> <span class=mi>8</span> <span class=o>+</span> <span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><h4 id=custom-3>Custom 3</h4><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-27.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-27_hu_642e7ed2363bb986.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-27_hu_4f32c663780fad4b.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>이 문제 또한 입력받은 문자열을 <code>check3</code> 함수로 전달하여 검증하는 것으로 보인다.</p><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-28.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-28_hu_b07c16b11340d220.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-28_hu_58e8914331af97d.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>검증하는 식은 <code>*(_BYTE *)(i + a1) + *((_BYTE *)&amp;v3 + i % 5) != *((_BYTE *)v5 + i)</code>이다.</p><p><code>v5</code>는 <code>"Mc|iw8}Tr[1KKp{eUErg4Sjf\\Vi]rOwdVFyfUEs_XHnMMSxLK66KJ^q[ZTkVX7nMJlpeWGz\\ZJpfUE4g"</code> 문자열에 뒤에 <code>0x806E5B5D656E447ALL</code>를 더한 값이고, <code>v3</code>는 hex로 변환하면 <code>0x4030201</code>인데, 여기에 <code>v4</code>의 값인 <code>5</code>를 더하면 <code>1 ~ 5</code>로 구성된 배열이 된다.</p><br><p>C++을 이용해 입력값을 구하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>v5</span><span class=p>[</span><span class=mi>88</span><span class=p>]</span> <span class=o>=</span> <span class=s>&#34;Mc|iw8}Tr[1KKp{eUErg4Sjf</span><span class=se>\\</span><span class=s>Vi]rOwdVFyfUEs_XHnMMSxLK66KJ^q[ZTkVX7nMJlpeWGz</span><span class=se>\\</span><span class=s>ZJpfUE4g&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span><span class=p>(</span><span class=kt>long</span> <span class=kt>long</span><span class=o>*</span><span class=p>)(</span><span class=n>v5</span> <span class=o>+</span> <span class=mi>80</span><span class=p>)</span> <span class=o>=</span> <span class=mh>0x806E5B5D656E447ALL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>v3</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>,</span> <span class=mh>0x04</span><span class=p>,</span> <span class=mh>0x05</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>ptr</span> <span class=o>=</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=n>v5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>88</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;</span><span class=p>(</span><span class=n>ptr</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>v3</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mi>5</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><h4 id=picoctf-file-run1>[PicoCTF] file-run1</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Documents/Coding/test via C v13.3.0-gcc via 🐍 v3.12.3
</span></span><span class=line><span class=cl>❯ ./Pico_run1
</span></span><span class=line><span class=cl>The flag is: picoCTF{U51N6_Y0Ur_F1r57_F113_9bc52b6b}
</span></span></code></pre></td></tr></table></div></div><p>실행하니까 그냥 플래그를 준다.</p><br><h4 id=picoctf-file-run2>[PicoCTF] file-run2</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Documents/Coding/test via C v13.3.0-gcc via 🐍 v3.12.3
</span></span><span class=line><span class=cl>❯ ./Pico_run2
</span></span><span class=line><span class=cl>Run this file with only one argument.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Documents/Coding/test via C v13.3.0-gcc via 🐍 v3.12.3
</span></span><span class=line><span class=cl>❯ ./Pico_run2 a
</span></span><span class=line><span class=cl>Won&#39;t you say &#39;Hello!&#39; to me first?
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Documents/Coding/test via C v13.3.0-gcc via 🐍 v3.12.3
</span></span><span class=line><span class=cl>❯ ./Pico_run2 Hello!
</span></span><span class=line><span class=cl>The flag is: picoCTF{F1r57_4rgum3n7_96f2195f}
</span></span></code></pre></td></tr></table></div></div><p>인사하라고 해서 인사해줬더니 플래그를 준다.</p><br><h4 id=merong>Merong</h4><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-29.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-29_hu_e419d2b6c2fb0742.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-29_hu_d17682decd5de50a.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p><code>aEae41779bdf799</code> 값이 플래그인 것 같다.</p><br><p><img src=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-30.png width=1535 height=856 srcset="/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-30_hu_7df3512d5ac14eef.png 480w, /p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-5%EC%B0%A8%EC%8B%9C/image-30_hu_ffac44b913b9b98d.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>Text view에서 확인할 수 있다.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/layer7/>Layer7</a>
<a href=/tags/reversing/>Reversing</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/layer7-reversing-mini-ctf-write-up/><div class=article-details><h2 class=article-title>Layer7 Reversing mini CTF | Write-up</h2></div></a></article><article><a href=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-8%EC%B0%A8%EC%8B%9C/><div class=article-details><h2 class=article-title>Layer7 리버싱 8차시</h2></div></a></article><article><a href=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-7%EC%B0%A8%EC%8B%9C/><div class=article-details><h2 class=article-title>Layer7 리버싱 7차시</h2></div></a></article><article><a href=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-6%EC%B0%A8%EC%8B%9C/><div class=article-details><h2 class=article-title>Layer7 리버싱 6차시</h2></div></a></article><article><a href=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-4%EC%B0%A8%EC%8B%9C/><div class=article-details><h2 class=article-title>Layer7 리버싱 4차시</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 T43W00</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>