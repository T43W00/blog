<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="웹 심화 문제 Open the door 패스워드를 입력받고 맞는 패스워드인지 검증하는 웹 사이트로 보인다.\n개발자 도구를 열어 html 코드를 보면 ljsdgoiqyokn.js라는 이름의 자바스크립트 파일을 불러오는 것을 알 수 있다.\n해당 파일을 확인해보면 조건문을 통해 입력된 패스워드가 9184736287인지 비교하여 검증하는 것을 알 수 있다.\n패스워드를 입력하면 플래그를 획득할 수 있다. 소스 코드를 볼 수 있는지 확인하는 문제였던 것 같다.\n"><title>HackQuest2025 Quals | Write-up</title><link rel=canonical href=https://t43w00.netlify.app/p/hackquest2025-quals-write-up/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="HackQuest2025 Quals | Write-up"><meta property='og:description' content="웹 심화 문제 Open the door 패스워드를 입력받고 맞는 패스워드인지 검증하는 웹 사이트로 보인다.\n개발자 도구를 열어 html 코드를 보면 ljsdgoiqyokn.js라는 이름의 자바스크립트 파일을 불러오는 것을 알 수 있다.\n해당 파일을 확인해보면 조건문을 통해 입력된 패스워드가 9184736287인지 비교하여 검증하는 것을 알 수 있다.\n패스워드를 입력하면 플래그를 획득할 수 있다. 소스 코드를 볼 수 있는지 확인하는 문제였던 것 같다.\n"><meta property='og:url' content='https://t43w00.netlify.app/p/hackquest2025-quals-write-up/'><meta property='og:site_name' content='T43W00'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2025-07-05T00:00:00+00:00'><meta property='article:modified_time' content='2025-07-05T00:00:00+00:00'><meta name=twitter:title content="HackQuest2025 Quals | Write-up"><meta name=twitter:description content="웹 심화 문제 Open the door 패스워드를 입력받고 맞는 패스워드인지 검증하는 웹 사이트로 보인다.\n개발자 도구를 열어 html 코드를 보면 ljsdgoiqyokn.js라는 이름의 자바스크립트 파일을 불러오는 것을 알 수 있다.\n해당 파일을 확인해보면 조건문을 통해 입력된 패스워드가 9184736287인지 비교하여 검증하는 것을 알 수 있다.\n패스워드를 입력하면 플래그를 획득할 수 있다. 소스 코드를 볼 수 있는지 확인하는 문제였던 것 같다.\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_da68217e1fd91b15.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🐱</span></figure><div class=site-meta><h1 class=site-name><a href=/>T43W00</a></h1><h2 class=site-description>정보보안 공부</h2></div></header><ol class=menu-social><li><a href=https://github.com/t43w00 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/743w00 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#웹-심화-문제>웹 심화 문제</a><ol><li><a href=#open-the-door>Open the door</a></li><li><a href=#image-downloader>Image Downloader</a></li></ol></li><li><a href=#리버싱-심화-문제>리버싱 심화 문제</a><ol><li><a href=#blackbox>blackbox</a></li></ol></li><li><a href=#암호학-심화-문제>암호학 심화 문제</a></li><li><a href=#ctr>CTR</a></li><li><a href=#인상-깊은-내용>인상 깊은 내용</a><ol><li><a href=#rop>ROP</a></li><li><a href=#bypass-aslr-연계된-문제>Bypass ASLR (연계된 문제)</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/hackquest2025-quals-write-up/>HackQuest2025 Quals | Write-up</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 05, 2025</time></div></footer></div></header><section class=article-content><h2 id=웹-심화-문제>웹 심화 문제</h2><h3 id=open-the-door>Open the door</h3><p><img src=/p/hackquest2025-quals-write-up/image.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image_hu_f9711bc25ade4315.png 480w, /p/hackquest2025-quals-write-up/image_hu_a645a423a9a1c036.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p>패스워드를 입력받고 맞는 패스워드인지 검증하는 웹 사이트로 보인다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-1.png width=581 height=191 srcset="/p/hackquest2025-quals-write-up/image-1_hu_6761bcfdc88a08dd.png 480w, /p/hackquest2025-quals-write-up/image-1_hu_a0d1ab6580a2867b.png 1024w" loading=lazy class=gallery-image data-flex-grow=304 data-flex-basis=730px></p><p>개발자 도구를 열어 html 코드를 보면 <code>ljsdgoiqyokn.js</code>라는 이름의 자바스크립트 파일을 불러오는 것을 알 수 있다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-2.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-2_hu_8f60a131716fcae3.png 480w, /p/hackquest2025-quals-write-up/image-2_hu_ccf897785ddb065b.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p>해당 파일을 확인해보면 조건문을 통해 입력된 패스워드가 <code>9184736287</code>인지 비교하여 검증하는 것을 알 수 있다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-3.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-3_hu_4fcdcf95528ea5c6.png 480w, /p/hackquest2025-quals-write-up/image-3_hu_50218d43fc6dd99c.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p>패스워드를 입력하면 플래그를 획득할 수 있다. 소스 코드를 볼 수 있는지 확인하는 문제였던 것 같다.</p><br><h3 id=image-downloader>Image Downloader</h3><p><img src=/p/hackquest2025-quals-write-up/image-4.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-4_hu_19b8b41dff78fd58.png 480w, /p/hackquest2025-quals-write-up/image-4_hu_57b7245c91a6a99e.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p>URL 필터를 우회하여 서버 내의 flag 파일을 다운로드 해야하는 문제이다.</p><p>비슷한 공격 기법들을 찾아보니, 이러한 공격을 SSRF라고 하는 듯하다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-5.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-5_hu_89e0f39eeca389da.png 480w, /p/hackquest2025-quals-write-up/image-5_hu_545089635c519f9.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px>
<img src=/p/hackquest2025-quals-write-up/image-9.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-9_hu_5d04be38aaf8d3d8.png 480w, /p/hackquest2025-quals-write-up/image-9_hu_75d4d79f86685149.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p>먼저 서버 내의 파일에 접근하려면 서버가 실행되는 <code>localhost</code>의 정해진 포트에 접속해야 한다고 생각했고, 이는 소스 코드에서 <code>127.0.0.1:3000</code>이 테스트 서버라는 정보를 알 수 있었다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-6.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-6_hu_6105dab3c9cdec8b.png 480w, /p/hackquest2025-quals-write-up/image-6_hu_d6181e6c657264e7.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p><code>SSRF bypass</code>를 찾아보니 URL의 로컬 호스트는 <code>127.1</code>로 간단히 우회할 수 있었다.</p><p>하지만 <code>/flag</code>는 금지된 경로라고 한다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-8.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-8_hu_153edc56ac338000.png 480w, /p/hackquest2025-quals-write-up/image-8_hu_90fdf970552eb071.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p>이후에도 다양한 방법을 시도해보았지만 에러가 났고, 인터넷에서 <code>CTF SSRF write-up</code>이라고 검색을 해보았더니 <code>,</code>를 사용한 우회를 확인할 수 있었다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-10.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-10_hu_2cf54260d51f443f.png 480w, /p/hackquest2025-quals-write-up/image-10_hu_70e075f13c575f65.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p>다운로드에 성공하였다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-7.png width=1920 height=1200 srcset="/p/hackquest2025-quals-write-up/image-7_hu_bb57100b9afb0726.png 480w, /p/hackquest2025-quals-write-up/image-7_hu_6a6f8b072845bc1b.png 1024w" loading=lazy class=gallery-image data-flex-grow=160 data-flex-basis=384px></p><p>이미지를 새 탭으로 열면 파일을 다운로드 받을 수 있고, 플래그를 확인할 수 있다.</p><br><hr><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><h2 id=리버싱-심화-문제>리버싱 심화 문제</h2><h3 id=blackbox>blackbox</h3><p><img src=/p/hackquest2025-quals-write-up/image-11.png width=1535 height=856 srcset="/p/hackquest2025-quals-write-up/image-11_hu_367ee6285de4b5d9.png 480w, /p/hackquest2025-quals-write-up/image-11_hu_d7e96044c5f329cf.png 1024w" loading=lazy class=gallery-image data-flex-grow=179 data-flex-basis=430px></p><p>문제 파일을 <code>IDA</code>로 열어 디컴파일 해보니 <code>sbox</code> 배열에서 입력값의 <code>i</code>번째 인덱스에 위치한 값을 <code>s1</code> 배열로 저장하고, 이를 <code>answer</code>에 위치한 <code>32byte</code>와 비교하는 것을 확인할 수 있다.</p><br><p>따라서 <code>sbox[i] == answer[j] (i : 0~255, j : 0~31)</code>일 때 <code>i</code>가 플래그의 <code>j</code>번째 인덱스의 값이 된다.</p><br><p>Python으로 전체 플래그를 구하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>answer</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x45</span><span class=p>,</span> <span class=mh>0xEF</span><span class=p>,</span> <span class=mh>0xFB</span><span class=p>,</span> <span class=mh>0x7F</span><span class=p>,</span> <span class=mh>0xA3</span><span class=p>,</span> <span class=mh>0x9D</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0x92</span><span class=p>,</span> <span class=mh>0x23</span><span class=p>,</span> <span class=mh>0x04</span><span class=p>,</span> <span class=mh>0x23</span><span class=p>,</span> <span class=mh>0x96</span><span class=p>,</span> <span class=mh>0x21</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0xAA</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xA8</span><span class=p>,</span> <span class=mh>0xBC</span><span class=p>,</span> <span class=mh>0xCF</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x40</span><span class=p>,</span> <span class=mh>0xA8</span><span class=p>,</span> <span class=mh>0x3C</span><span class=p>,</span> <span class=mh>0xCF</span><span class=p>,</span> <span class=mh>0xEF</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0xCF</span><span class=p>,</span> <span class=mh>0x58</span><span class=p>,</span> <span class=mh>0xCF</span><span class=p>,</span> <span class=mh>0x58</span><span class=p>,</span> <span class=mh>0xFF</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sbox</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=mh>0x63</span><span class=p>,</span> <span class=mh>0x7C</span><span class=p>,</span> <span class=mh>0x77</span><span class=p>,</span> <span class=mh>0x7B</span><span class=p>,</span> <span class=mh>0xF2</span><span class=p>,</span> <span class=mh>0x6B</span><span class=p>,</span> <span class=mh>0x6F</span><span class=p>,</span> <span class=mh>0xC5</span><span class=p>,</span> <span class=mh>0x30</span><span class=p>,</span> <span class=mh>0x01</span><span class=p>,</span> <span class=mh>0x67</span><span class=p>,</span> <span class=mh>0x2B</span><span class=p>,</span> <span class=mh>0xFE</span><span class=p>,</span> <span class=mh>0xD7</span><span class=p>,</span> <span class=mh>0xAB</span><span class=p>,</span> <span class=mh>0x76</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xCA</span><span class=p>,</span> <span class=mh>0x82</span><span class=p>,</span> <span class=mh>0xC9</span><span class=p>,</span> <span class=mh>0x7D</span><span class=p>,</span> <span class=mh>0xFA</span><span class=p>,</span> <span class=mh>0x59</span><span class=p>,</span> <span class=mh>0x47</span><span class=p>,</span> <span class=mh>0xF0</span><span class=p>,</span> <span class=mh>0xAD</span><span class=p>,</span> <span class=mh>0xD4</span><span class=p>,</span> <span class=mh>0xA2</span><span class=p>,</span> <span class=mh>0xAF</span><span class=p>,</span> <span class=mh>0x9C</span><span class=p>,</span> <span class=mh>0xA4</span><span class=p>,</span> <span class=mh>0x72</span><span class=p>,</span> <span class=mh>0xC0</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xB7</span><span class=p>,</span> <span class=mh>0xFD</span><span class=p>,</span> <span class=mh>0x93</span><span class=p>,</span> <span class=mh>0x26</span><span class=p>,</span> <span class=mh>0x36</span><span class=p>,</span> <span class=mh>0x3F</span><span class=p>,</span> <span class=mh>0xF7</span><span class=p>,</span> <span class=mh>0xCC</span><span class=p>,</span> <span class=mh>0x34</span><span class=p>,</span> <span class=mh>0xA5</span><span class=p>,</span> <span class=mh>0xE5</span><span class=p>,</span> <span class=mh>0xF1</span><span class=p>,</span> <span class=mh>0x71</span><span class=p>,</span> <span class=mh>0xD8</span><span class=p>,</span> <span class=mh>0x31</span><span class=p>,</span> <span class=mh>0x15</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x04</span><span class=p>,</span> <span class=mh>0xC7</span><span class=p>,</span> <span class=mh>0x23</span><span class=p>,</span> <span class=mh>0xC3</span><span class=p>,</span> <span class=mh>0x18</span><span class=p>,</span> <span class=mh>0x96</span><span class=p>,</span> <span class=mh>0x05</span><span class=p>,</span> <span class=mh>0x9A</span><span class=p>,</span> <span class=mh>0x07</span><span class=p>,</span> <span class=mh>0x12</span><span class=p>,</span> <span class=mh>0x80</span><span class=p>,</span> <span class=mh>0xE2</span><span class=p>,</span> <span class=mh>0xEB</span><span class=p>,</span> <span class=mh>0x27</span><span class=p>,</span> <span class=mh>0xB2</span><span class=p>,</span> <span class=mh>0x75</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x09</span><span class=p>,</span> <span class=mh>0x83</span><span class=p>,</span> <span class=mh>0x2C</span><span class=p>,</span> <span class=mh>0x1A</span><span class=p>,</span> <span class=mh>0x1B</span><span class=p>,</span> <span class=mh>0x6E</span><span class=p>,</span> <span class=mh>0x5A</span><span class=p>,</span> <span class=mh>0xA0</span><span class=p>,</span> <span class=mh>0x52</span><span class=p>,</span> <span class=mh>0x3B</span><span class=p>,</span> <span class=mh>0xD6</span><span class=p>,</span> <span class=mh>0xB3</span><span class=p>,</span> <span class=mh>0x29</span><span class=p>,</span> <span class=mh>0xE3</span><span class=p>,</span> <span class=mh>0x2F</span><span class=p>,</span> <span class=mh>0x84</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x53</span><span class=p>,</span> <span class=mh>0xD1</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0xED</span><span class=p>,</span> <span class=mh>0x20</span><span class=p>,</span> <span class=mh>0xFC</span><span class=p>,</span> <span class=mh>0xB1</span><span class=p>,</span> <span class=mh>0x5B</span><span class=p>,</span> <span class=mh>0x6A</span><span class=p>,</span> <span class=mh>0xCB</span><span class=p>,</span> <span class=mh>0xBE</span><span class=p>,</span> <span class=mh>0x39</span><span class=p>,</span> <span class=mh>0x4A</span><span class=p>,</span> <span class=mh>0x4C</span><span class=p>,</span> <span class=mh>0x58</span><span class=p>,</span> <span class=mh>0xCF</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xD0</span><span class=p>,</span> <span class=mh>0xEF</span><span class=p>,</span> <span class=mh>0xAA</span><span class=p>,</span> <span class=mh>0xFB</span><span class=p>,</span> <span class=mh>0x43</span><span class=p>,</span> <span class=mh>0x4D</span><span class=p>,</span> <span class=mh>0x33</span><span class=p>,</span> <span class=mh>0x85</span><span class=p>,</span> <span class=mh>0x45</span><span class=p>,</span> <span class=mh>0xF9</span><span class=p>,</span> <span class=mh>0x02</span><span class=p>,</span> <span class=mh>0x7F</span><span class=p>,</span> <span class=mh>0x50</span><span class=p>,</span> <span class=mh>0x3C</span><span class=p>,</span> <span class=mh>0x9F</span><span class=p>,</span> <span class=mh>0xA8</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x51</span><span class=p>,</span> <span class=mh>0xA3</span><span class=p>,</span> <span class=mh>0x40</span><span class=p>,</span> <span class=mh>0x8F</span><span class=p>,</span> <span class=mh>0x92</span><span class=p>,</span> <span class=mh>0x9D</span><span class=p>,</span> <span class=mh>0x38</span><span class=p>,</span> <span class=mh>0xF5</span><span class=p>,</span> <span class=mh>0xBC</span><span class=p>,</span> <span class=mh>0xB6</span><span class=p>,</span> <span class=mh>0xDA</span><span class=p>,</span> <span class=mh>0x21</span><span class=p>,</span> <span class=mh>0x10</span><span class=p>,</span> <span class=mh>0xFF</span><span class=p>,</span> <span class=mh>0xF3</span><span class=p>,</span> <span class=mh>0xD2</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xCD</span><span class=p>,</span> <span class=mh>0x0C</span><span class=p>,</span> <span class=mh>0x13</span><span class=p>,</span> <span class=mh>0xEC</span><span class=p>,</span> <span class=mh>0x5F</span><span class=p>,</span> <span class=mh>0x97</span><span class=p>,</span> <span class=mh>0x44</span><span class=p>,</span> <span class=mh>0x17</span><span class=p>,</span> <span class=mh>0xC4</span><span class=p>,</span> <span class=mh>0xA7</span><span class=p>,</span> <span class=mh>0x7E</span><span class=p>,</span> <span class=mh>0x3D</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>,</span> <span class=mh>0x5D</span><span class=p>,</span> <span class=mh>0x19</span><span class=p>,</span> <span class=mh>0x73</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x60</span><span class=p>,</span> <span class=mh>0x81</span><span class=p>,</span> <span class=mh>0x4F</span><span class=p>,</span> <span class=mh>0xDC</span><span class=p>,</span> <span class=mh>0x22</span><span class=p>,</span> <span class=mh>0x2A</span><span class=p>,</span> <span class=mh>0x90</span><span class=p>,</span> <span class=mh>0x88</span><span class=p>,</span> <span class=mh>0x46</span><span class=p>,</span> <span class=mh>0xEE</span><span class=p>,</span> <span class=mh>0xB8</span><span class=p>,</span> <span class=mh>0x14</span><span class=p>,</span> <span class=mh>0xDE</span><span class=p>,</span> <span class=mh>0x5E</span><span class=p>,</span> <span class=mh>0x0B</span><span class=p>,</span> <span class=mh>0xDB</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xE0</span><span class=p>,</span> <span class=mh>0x32</span><span class=p>,</span> <span class=mh>0x3A</span><span class=p>,</span> <span class=mh>0x0A</span><span class=p>,</span> <span class=mh>0x49</span><span class=p>,</span> <span class=mh>0x06</span><span class=p>,</span> <span class=mh>0x24</span><span class=p>,</span> <span class=mh>0x5C</span><span class=p>,</span> <span class=mh>0xC2</span><span class=p>,</span> <span class=mh>0xD3</span><span class=p>,</span> <span class=mh>0xAC</span><span class=p>,</span> <span class=mh>0x62</span><span class=p>,</span> <span class=mh>0x91</span><span class=p>,</span> <span class=mh>0x95</span><span class=p>,</span> <span class=mh>0xE4</span><span class=p>,</span> <span class=mh>0x79</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xE7</span><span class=p>,</span> <span class=mh>0xC8</span><span class=p>,</span> <span class=mh>0x37</span><span class=p>,</span> <span class=mh>0x6D</span><span class=p>,</span> <span class=mh>0x8D</span><span class=p>,</span> <span class=mh>0xD5</span><span class=p>,</span> <span class=mh>0x4E</span><span class=p>,</span> <span class=mh>0xA9</span><span class=p>,</span> <span class=mh>0x6C</span><span class=p>,</span> <span class=mh>0x56</span><span class=p>,</span> <span class=mh>0xF4</span><span class=p>,</span> <span class=mh>0xEA</span><span class=p>,</span> <span class=mh>0x65</span><span class=p>,</span> <span class=mh>0x7A</span><span class=p>,</span> <span class=mh>0xAE</span><span class=p>,</span> <span class=mh>0x08</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xBA</span><span class=p>,</span> <span class=mh>0x78</span><span class=p>,</span> <span class=mh>0x25</span><span class=p>,</span> <span class=mh>0x2E</span><span class=p>,</span> <span class=mh>0x1C</span><span class=p>,</span> <span class=mh>0xA6</span><span class=p>,</span> <span class=mh>0xB4</span><span class=p>,</span> <span class=mh>0xC6</span><span class=p>,</span> <span class=mh>0xE8</span><span class=p>,</span> <span class=mh>0xDD</span><span class=p>,</span> <span class=mh>0x74</span><span class=p>,</span> <span class=mh>0x1F</span><span class=p>,</span> <span class=mh>0x4B</span><span class=p>,</span> <span class=mh>0xBD</span><span class=p>,</span> <span class=mh>0x8B</span><span class=p>,</span> <span class=mh>0x8A</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x70</span><span class=p>,</span> <span class=mh>0x3E</span><span class=p>,</span> <span class=mh>0xB5</span><span class=p>,</span> <span class=mh>0x66</span><span class=p>,</span> <span class=mh>0x48</span><span class=p>,</span> <span class=mh>0x03</span><span class=p>,</span> <span class=mh>0xF6</span><span class=p>,</span> <span class=mh>0x0E</span><span class=p>,</span> <span class=mh>0x61</span><span class=p>,</span> <span class=mh>0x35</span><span class=p>,</span> <span class=mh>0x57</span><span class=p>,</span> <span class=mh>0xB9</span><span class=p>,</span> <span class=mh>0x86</span><span class=p>,</span> <span class=mh>0xC1</span><span class=p>,</span> <span class=mh>0x1D</span><span class=p>,</span> <span class=mh>0x9E</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0xE1</span><span class=p>,</span> <span class=mh>0xF8</span><span class=p>,</span> <span class=mh>0x98</span><span class=p>,</span> <span class=mh>0x11</span><span class=p>,</span> <span class=mh>0x69</span><span class=p>,</span> <span class=mh>0xD9</span><span class=p>,</span> <span class=mh>0x8E</span><span class=p>,</span> <span class=mh>0x94</span><span class=p>,</span> <span class=mh>0x9B</span><span class=p>,</span> <span class=mh>0x1E</span><span class=p>,</span> <span class=mh>0x87</span><span class=p>,</span> <span class=mh>0xE9</span><span class=p>,</span> <span class=mh>0xCE</span><span class=p>,</span> <span class=mh>0x55</span><span class=p>,</span> <span class=mh>0x28</span><span class=p>,</span> <span class=mh>0xDF</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=mh>0x8C</span><span class=p>,</span> <span class=mh>0xA1</span><span class=p>,</span> <span class=mh>0x89</span><span class=p>,</span> <span class=mh>0x0D</span><span class=p>,</span> <span class=mh>0xBF</span><span class=p>,</span> <span class=mh>0xE6</span><span class=p>,</span> <span class=mh>0x42</span><span class=p>,</span> <span class=mh>0x68</span><span class=p>,</span> <span class=mh>0x41</span><span class=p>,</span> <span class=mh>0x99</span><span class=p>,</span> <span class=mh>0x2D</span><span class=p>,</span> <span class=mh>0x0F</span><span class=p>,</span> <span class=mh>0xB0</span><span class=p>,</span> <span class=mh>0x54</span><span class=p>,</span> <span class=mh>0xBB</span><span class=p>,</span> <span class=mh>0x16</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>sbox</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>answer</span><span class=p>[</span><span class=n>j</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>flag</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>flag</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><br><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>t43w00</span><span class=o>/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>rev</span><span class=o>-</span><span class=n>blackbox</span><span class=o>.</span><span class=mi>711375</span><span class=n>bad41e6b3ca6cda0c4d0beccb0</span> <span class=n>via</span> <span class=err>🐍</span> <span class=n>v3</span><span class=o>.</span><span class=mf>12.3</span> <span class=n>took</span> <span class=mi>7</span><span class=n>s</span>
</span></span><span class=line><span class=cl><span class=err>❯</span> <span class=n>python3</span> <span class=n>solve</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=n>hackquest2025</span><span class=p>{</span><span class=n>sbox_from_aes_</span><span class=o>^</span><span class=n>_</span><span class=o>^</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><br><br><br><h2 id=암호학-심화-문제>암호학 심화 문제</h2><h2 id=ctr>CTR</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>nonce</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CTR</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CTR</span><span class=p>,</span> <span class=n>nonce</span><span class=o>=</span><span class=n>nonce</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.txt&#34;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>())</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>코드를 보면 AES의 CTR(카운터 방식) 모드로 두 평문을 <strong>같은 nonce</strong>로 암호화 하는 것을 확인할 수 있다.</p><br><p><img src=/p/hackquest2025-quals-write-up/image-12.png width=620 height=495 srcset="/p/hackquest2025-quals-write-up/image-12_hu_2c7a593b6a600439.png 480w, /p/hackquest2025-quals-write-up/image-12_hu_74fa0d8ec137243b.png 1024w" loading=lazy class=gallery-image data-flex-grow=125 data-flex-basis=300px></p><p>CTR 모드를 보면 <code>Nonce</code>와 <code>Counter</code>를 <code>AES</code> 암호화를 통해 키스트림을 생성하고, 이를 평문과 <code>XOR</code> 연산하여 암호문을 만든다.</p><br><p>따라서 하나의 평문과 암호문이 있다면, 같은 Nonce를 사용한 암호문을 아래와 같은 방법으로 복호화할 수 있다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>암호문1 = 평문1 ⊕ 키스트림
</span></span><span class=line><span class=cl>암호문2 = 평문2 ⊕ 키스트림
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓ 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>키스트림 = 암호문1 ⊕ 평문1
</span></span><span class=line><span class=cl>평문2 = 암호문2 ⊕ 키스트림
</span></span></code></pre></td></tr></table></div></div><br><p>Python으로 위 방법으로 암호화된 플래그를 복호화하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Cipher1 = &#34;481b616b48d74a997a8a5d3be871de64a6bf91cf0d8b7fa795643b61803ca66858604e4eef13ffb99fef62a871599b85154d531f822029a2f5c9822c08df719312dc3d838e816173e386d185427ff39a7c2f0da7f7519e047bd5df9257af9e8305d431453e2ed042771d261f07fb16a1c6bfa9c86238979dc7656b&#34;
</span></span><span class=line><span class=cl>Cipher2 = &#34;471b7d695796579c659e4472e370c12af4d98ec71e913ea291737c309636bb6f0f33081ee008e2f79dee54b16b75969916481608b13c2eebb1e5d7264bde63&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Cipher1 = bytes.fromhex(Cipher1)
</span></span><span class=line><span class=cl>Cipher2 = bytes.fromhex(Cipher2)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Plain1 = b&#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>keystream = bytes(a ^ b for a, b in zip(Cipher1, Plain1))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>flag = bytes(a ^ b for a, b in zip(Cipher2, keystream))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print(flag.decode())
</span></span></code></pre></td></tr></table></div></div><br><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>t43w00</span><span class=o>/</span><span class=n>Downloads</span><span class=o>/</span><span class=n>crypto</span><span class=o>-</span><span class=n>ctr</span><span class=o>.</span><span class=mi>0</span><span class=n>fb3a839fadcbd2ff7091d60291d7d1e</span> <span class=n>via</span> <span class=err>🐍</span> <span class=n>v3</span><span class=o>.</span><span class=mf>12.3</span>
</span></span><span class=line><span class=cl><span class=err>❯</span> <span class=n>python3</span> <span class=n>decrypt</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=n>Congratulations</span><span class=o>!</span> <span class=n>Flag</span><span class=p>:</span> <span class=n>hackquest2025</span><span class=p>{</span><span class=n>nonce_is_number_used_0nce</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><hr><br><h2 id=인상-깊은-내용>인상 깊은 내용</h2><p>리버스 엔지니어링은 평소에 간단한 역연산 문제들을 풀어본 경험이 있기 때문에 순조롭게 진행할 수 있었지만, 포너블의 경우에는 처음 공부하는 분야였기에 굉장히 흥미롭게 느껴졌던 것 같다.</p><br><h3 id=rop>ROP</h3><p>ROP(Return-oriented programming)는 정말 처음 공부했을 땐 &lsquo;어떻게 이런 공격 방법을 생각해낼 수 있지?&rsquo; 하는 생각이 들 정도로 참신한 공격이었다.</p><p>어셈블리어 코드에서 <code>pop rdi; ret</code>과 같은 코드 조각들을 모아 이를 <code>jmp</code> 명령어처럼 이용하는 것이 너무 인상적이었다.</p><p>또한 단일로 쓰이지 않고 BOF를 비롯한 다양한 공격과 연계되어 쓰여서 문제 풀이에 자주 사용되어 기억에 남았다.</p><br><h3 id=bypass-aslr-연계된-문제>Bypass ASLR (연계된 문제)</h3><p>이 문제를 풀기 전까지는 그냥 주어진 주소를 가지고 ROP를 통해 익스플로잇하면 되기 때문에 순조롭게 풀이할 수 있었다.</p><p>하지만 이 문제는 다르게 ASLR이 활성화되어 있어서 주소를 오프셋을 통해 동적으로 구해야했다.</p><p>처음에는 그냥 빈 배열에 있는 값들을 출력해주는 걸 보고 &lsquo;잘못 출제된 문제인가?&rsquo; 싶었지만, 주소의 형식으로 출력된 것을 보고 하나하나 <code>gdb</code>로 확인해보니 전 함수에서 쓰인 함수의 주소가 스택에 남아있어, 해당 함수의 주소가 출력된 것을 알 수 있었고, 이를 통해 libc base 주소를 구할 수 있었다.</p><p>이 문제를 통해 느낀 점은, 포너블은 바이너리가 의도한 사항이 아니더라도, 어떻게든 악용할 수 있는 정보들을 모아 익스플로잇을 해야한다는 것이었다. 내가 평소에 풀던 리버싱 역연산 문제들은 바이너리를 보고 주어진 정보들을 계산만 하면 그만이었지만, 포너블의 경우에는 작은 가능성도 놓치지 않고 다양한 시도를 해야하는 것 같다. 그만큼 숨겨진 취약점을 찾는 과정이 재미있고, 성공했을 때의 성취감이 더 높은 것 같다는 생각이 들었다.</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 T43W00</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>