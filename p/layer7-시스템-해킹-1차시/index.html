<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Dreamhack 학습 정리 (~ pwntools 기초) 컴퓨터 아키텍처 컴퓨터 아키텍처는 컴퓨터에 관한 설계를 뜻한다.\n컴퓨터 아키텍처는 명령어적 설계인 명령어 집합구조(Instruction Set Architecture)와 하드웨어적 설계인 마이크로 아키텍처(Micro Architecture)로 나뉜다.\n특히 CPU가 컴퓨터의 동작에 핵심적인 역할을 하기 때문에, 명령어 집합구조를 알 필요가 있다.\n폰 노이만 구조 근대의 컴퓨터는 폰 노이만 구조에 기반을 둔다.\n폰 노이만 구조는 연산, 제어, 저장의 세 가지 핵심 기능이 필요로 한다.\n근대의 컴퓨터는 CPU가 연산과 제어를, 메모리가 저장을 담당한다.\n"><title>Layer7 시스템 해킹 1차시</title><link rel=canonical href=https://t43w00.netlify.app/p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Layer7 시스템 해킹 1차시"><meta property='og:description' content="Dreamhack 학습 정리 (~ pwntools 기초) 컴퓨터 아키텍처 컴퓨터 아키텍처는 컴퓨터에 관한 설계를 뜻한다.\n컴퓨터 아키텍처는 명령어적 설계인 명령어 집합구조(Instruction Set Architecture)와 하드웨어적 설계인 마이크로 아키텍처(Micro Architecture)로 나뉜다.\n특히 CPU가 컴퓨터의 동작에 핵심적인 역할을 하기 때문에, 명령어 집합구조를 알 필요가 있다.\n폰 노이만 구조 근대의 컴퓨터는 폰 노이만 구조에 기반을 둔다.\n폰 노이만 구조는 연산, 제어, 저장의 세 가지 핵심 기능이 필요로 한다.\n근대의 컴퓨터는 CPU가 연산과 제어를, 메모리가 저장을 담당한다.\n"><meta property='og:url' content='https://t43w00.netlify.app/p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/'><meta property='og:site_name' content='T43W00'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Layer7'><meta property='article:tag' content='System Hacking'><meta property='article:published_time' content='2025-09-26T00:00:00+00:00'><meta property='article:modified_time' content='2025-09-26T00:00:00+00:00'><meta name=twitter:title content="Layer7 시스템 해킹 1차시"><meta name=twitter:description content="Dreamhack 학습 정리 (~ pwntools 기초) 컴퓨터 아키텍처 컴퓨터 아키텍처는 컴퓨터에 관한 설계를 뜻한다.\n컴퓨터 아키텍처는 명령어적 설계인 명령어 집합구조(Instruction Set Architecture)와 하드웨어적 설계인 마이크로 아키텍처(Micro Architecture)로 나뉜다.\n특히 CPU가 컴퓨터의 동작에 핵심적인 역할을 하기 때문에, 명령어 집합구조를 알 필요가 있다.\n폰 노이만 구조 근대의 컴퓨터는 폰 노이만 구조에 기반을 둔다.\n폰 노이만 구조는 연산, 제어, 저장의 세 가지 핵심 기능이 필요로 한다.\n근대의 컴퓨터는 CPU가 연산과 제어를, 메모리가 저장을 담당한다.\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_da68217e1fd91b15.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🐱</span></figure><div class=site-meta><h1 class=site-name><a href=/>T43W00</a></h1><h2 class=site-description>정보보안 공부</h2></div></header><ol class=menu-social><li><a href=https://github.com/t43w00 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/743w00 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#dreamhack-학습-정리--pwntools-기초>Dreamhack 학습 정리 (~ pwntools 기초)</a><ol><li><a href=#컴퓨터-아키텍처>컴퓨터 아키텍처</a></li><li><a href=#폰-노이만-구조>폰 노이만 구조</a></li><li><a href=#명령어-집합-구조>명령어 집합 구조</a></li><li><a href=#x86-64-레지스터>x86-64: 레지스터</a><ol><li><a href=#범용-레지스터>범용 레지스터</a></li><li><a href=#세그먼트-레지스터>세그먼트 레지스터</a></li><li><a href=#명령어-포인터-레지스터>명령어 포인터 레지스터</a></li><li><a href=#플래그-레지스터>플래그 레지스터</a></li></ol></li><li><a href=#메모리-레이아웃>메모리 레이아웃</a><ol><li><a href=#코드-세그먼트-r---x>코드 세그먼트 (R - X)</a></li><li><a href=#데이터-세그먼트-r-w----r---->데이터 세그먼트 (R W - / R - -)</a></li><li><a href=#bss-세그먼트-r-w-->BSS 세그먼트 (R W -)</a></li><li><a href=#스택-세그먼트-r-w-->스택 세그먼트 (R W -)</a></li><li><a href=#힙-세그먼트-r---x>힙 세그먼트 (R - X)</a></li></ol></li><li><a href=#어셈블리어>어셈블리어</a><ol><li><a href=#문법-구조>문법 구조</a></li><li><a href=#명령어-종류>명령어 종류</a></li></ol></li><li><a href=#gdb>GDB</a><ol><li><a href=#명령어-종류-1>명령어 종류</a></li><li><a href=#exercise-gdb>Exercise: GDB</a></li></ol></li><li><a href=#pwntools>pwntools</a><ol><li><a href=#함수-종류>함수 종류</a></li><li><a href=#addition-quiz>addition-quiz</a></li><li><a href=#flag-shop>flag-shop</a></li></ol></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/layer7/>Layer7
</a><a href=/categories/system-hacking/>System Hacking</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/>Layer7 시스템 해킹 1차시</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 26, 2025</time></div></footer></div></header><section class=article-content><h2 id=dreamhack-학습-정리--pwntools-기초>Dreamhack 학습 정리 (~ pwntools 기초)</h2><hr><h3 id=컴퓨터-아키텍처>컴퓨터 아키텍처</h3><p>컴퓨터 아키텍처는 컴퓨터에 관한 설계를 뜻한다.</p><p>컴퓨터 아키텍처는 명령어적 설계인 명령어 집합구조(Instruction Set Architecture)와 하드웨어적 설계인 마이크로 아키텍처(Micro Architecture)로 나뉜다.</p><p>특히 CPU가 컴퓨터의 동작에 핵심적인 역할을 하기 때문에, 명령어 집합구조를 알 필요가 있다.</p><hr><h3 id=폰-노이만-구조>폰 노이만 구조</h3><p>근대의 컴퓨터는 폰 노이만 구조에 기반을 둔다.</p><p>폰 노이만 구조는 <strong>연산</strong>, <strong>제어</strong>, <strong>저장</strong>의 세 가지 핵심 기능이 필요로 한다.</p><p>근대의 컴퓨터는 CPU가 <strong>연산</strong>과 <strong>제어</strong>를, 메모리가 <strong>저장</strong>을 담당한다.</p><p>또한 버스(Bus)라는 전자 통로가 추가적으로 존재하는데, 장치간 데이터나 제어 신호를 교환하기 위해 사용한다.</p><hr><h3 id=명령어-집합-구조>명령어 집합 구조</h3><p>명령어 집합 구조는 크게 <strong>CISC</strong>와 <strong>RISC</strong> 두 가지로 나눈다.</p><ul><li><code>CISC</code> : 70년대에 메모리 효율성에 맞춰 개발된 명령어 집합 구조이다. 예로는 x86-64가 이를 사용한다.</li><li><code>RISC</code> : 80년대에 CISC 구조의 단점을 개선하여 나온 명령어 집합 구조이며, 명령어 길이가 짧고 고정된 길이의 명령어만 사용한다. 예로는 ARM과 MIPS가 이를 사용한다.</li></ul><p>아직 x86-64 아키텍처를 PC에서 가장 보편적으로 사용하기 때문에 이를 깊게 공부할 필요가 있다.</p><p>x86-64의 이름을 봐도 알 수 있듯이 32비트와 64비트를 모두 호환하여 지원하는 아키텍처인데, 여기서 말하는 n비트는 cpu가 한번에 처리할 수 있는 데이터의 크기를 말한다.</p><p>또한 WORD라는 표현은 16비트를 말하는데, WORD 또한 CPU로 한 번에 처리할 수 있는 데이터의 크기를 이르는 말이었지만, 16비트를 사용할 때 쓰던 WORD가 굳어져 쓰이게 되었다.</p><hr><h3 id=x86-64-레지스터>x86-64: 레지스터</h3><hr><h4 id=범용-레지스터>범용 레지스터</h4><p>주로 데이터 연산을 위해 사용하는 레지스터이다.</p><p>특정 레지스터의 경우 주로 사용하는 용도가 있다.</p><ul><li><code>rax</code> : 함수의 반환값</li><li><code>rcx</code> : 반복문 카운터</li><li><code>rsi</code> : 데이터 원본 포인터</li><li><code>rdi</code> : 데이터 목적지 포인터</li><li><code>rsp</code> : 스택 포인터</li><li><code>rbp</code> : 스택 베이스 포인터</li></ul><hr><h4 id=세그먼트-레지스터>세그먼트 레지스터</h4><p>메모리를 세그먼트 단위로 접근할 때 사용하는 특수한 레지스터이다.</p><ul><li><code>CS</code> : 실행할 코드의 시작 주소 저장</li><li><code>DS</code> : 데이터 영역의 시작 주소 저장</li><li><code>SS</code> : 스택 영역의 시작 주소 저장</li><li><code>ES</code>, <code>FS</code>, <code>GS</code> : 범용적인 용도로 사용</li></ul><hr><h4 id=명령어-포인터-레지스터>명령어 포인터 레지스터</h4><p>명령어 포인터 레지스터는 CPU가 어느 부분의 코드를 실행할지 가리키는 역할을 한다.</p><p>x64 아키텍처에서의 명령어 포인터 레지스터는 <code>rip</code>이다.</p><hr><h4 id=플래그-레지스터>플래그 레지스터</h4><p>플래그 레지스터는 CPU가 연산을 수행한 후 결과의 상태를 저장하는 레지스터이다.</p><p>대표적으로는 ZF, CF, SF, OF 등이 있다.</p><ul><li><code>ZF</code> : 연산 결과가 0인 경우 설정</li><li><code>CF</code> : 올림수가 있는 경우 설정</li><li><code>SF</code> : 연산 결과가 음수인 경우 설정</li><li><code>OF</code> : 오버플로우 발생 시 설정</li></ul><hr><h3 id=메모리-레이아웃>메모리 레이아웃</h3><p>리눅스에서 프로세스의 메모리는 크게 5가지 세그먼트로 구분한다.</p><p>코드, 데이터, BSS, 힙, 스택이 있다.</p><hr><h4 id=코드-세그먼트-r---x>코드 세그먼트 (R - X)</h4><p>실행 가능한 기계어 코드가 위치하는 영역이다. 가장 낮은 주소에 위치한다.</p><p>쓰기 권한이 주어지지 않는 이유는 취약점을 통해 악의적인 공격이 가능하기 때문이다.</p><hr><h4 id=데이터-세그먼트-r-w----r---->데이터 세그먼트 (R W - / R - -)</h4><p>컴파일 시점에서 값이 정해진 전역 변수 및 전역 상수들이 위치하는 영역이다.</p><p>데이터 세그먼트의 경우에는 쓰기 가능한 영역과 불가능한 영역으로 다시 나뉜다.</p><p>rodata 영역은 쓰기 불가능한 읽기 전용 영역이다.</p><hr><h4 id=bss-세그먼트-r-w-->BSS 세그먼트 (R W -)</h4><p>컴파일 시점에 값이 정해지지 않은 전역 변수가 위치하는 영역이다.</p><p>초기화되지 않은 값은 프로그램이 시작될 때 0으로 초기화된다.</p><hr><h4 id=스택-세그먼트-r-w-->스택 세그먼트 (R W -)</h4><p>프로세스의 스택이 위치하는 영역이다.</p><p>함수의 매개변수나 지역 변수와 같은 임시 변수들이 이곳에 저장된다.</p><hr><h4 id=힙-세그먼트-r---x>힙 세그먼트 (R - X)</h4><p>동적으로 할당받는 메모리가 위치하는 영역이다.</p><p>힙 세그먼트는 스택 세그먼트와 반대 방향으로 자란다. (낮은 주소에서 높은 주소로)</p><hr><h3 id=어셈블리어>어셈블리어</h3><p>어셈블리어는 기계어와 1대1 대응되는 저수준 언어이다.</p><p>기계어를 보다 쉽게 이해하고 분석하기 위해 사용한다.</p><hr><h4 id=문법-구조>문법 구조</h4><p>어셈블리어의 기본 문법 구조는 명령어(Opcode)와 피연산자(Operand)로 구성된다.</p><p>예를 들어, <code>mov rax, 0x30</code>에서 명령어는 <code>mov</code>이고, 피연산자는 <code>rax</code>와 <code>0x30</code>이다.</p><hr><h4 id=명령어-종류>명령어 종류</h4><p>어셈블리어에는 매우 많은 명령어가 존재하지만 자주 사용되는 것은 저절로 알게 된다.</p><ul><li>데이터 이동 : <code>mov</code>, <code>lea</code></li><li>산술 연산 : <code>inc</code>, <code>dec</code>, <code>add</code>, <code>sub</code></li><li>논리 연산 : <code>and</code>, <code>or</code>, <code>xor</code>, <code>not</code></li><li>비교 : <code>cmp</code>, <code>test</code></li><li>분기 : <code>jmp</code>, <code>je</code>, <code>jg</code></li><li>스택 : <code>pop</code>, <code>push</code></li><li>프로시저 : <code>call</code>, <code>ret</code>, <code>leave</code></li><li>시스템 콜 : <code>syscall</code></li></ul><hr><h3 id=gdb>GDB</h3><p>GDB는 바이너리를 디버깅하기 위한 도구이다.</p><hr><h4 id=명령어-종류-1>명령어 종류</h4><p><code>file</code> : 파일 불러오기
<code>run</code> : 실행
<code>break</code> : 중단점 설정
<code>ni</code> : 다음 코드 실행
<code>si</code> : 다음 코드 실행 (함수 내부로 진입)
<code>disassemble</code> : 디스어셈블 코드 출력
<code>x</code> : 메모리 값 확인
<code>vmmap</code> : 가상 메모리 레이아웃 확인
<code>set</code> : 메모리 값 설정</p><hr><h4 id=exercise-gdb>Exercise: GDB</h4><p><code>b flag_1</code> 명령어로 중단점을 설정한 뒤 실행하고, <code>finish</code> 명령어로 <code>flag_1</code> 함수를 끝까지 실행하게 되면 <code>rax</code> 레지스터에서 반환값을 확인할 수 있다.</p><p><img src=/p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/image.png width=1920 height=1080 srcset="/p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/image_hu_2769487db543f294.png 480w, /p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/image_hu_d33a6519a7b78146.png 1024w" loading=lazy class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><br><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>pwndbg&gt; disassemble 
</span></span><span class=line><span class=cl>Dump of assembler code for function main:
</span></span><span class=line><span class=cl>   0x0000000000401156 &lt;+0&gt;:     endbr64
</span></span><span class=line><span class=cl>   0x000000000040115a &lt;+4&gt;:     push   rbp
</span></span><span class=line><span class=cl>   0x000000000040115b &lt;+5&gt;:     mov    rbp,rsp
</span></span><span class=line><span class=cl>   0x000000000040115e &lt;+8&gt;:     lea    rax,[rip+0xea3]        # 0x402008
</span></span><span class=line><span class=cl>   0x0000000000401165 &lt;+15&gt;:    mov    rdi,rax
</span></span><span class=line><span class=cl>   0x0000000000401168 &lt;+18&gt;:    call   0x401050 &lt;puts@plt&gt;
</span></span><span class=line><span class=cl>   0x000000000040116d &lt;+23&gt;:    call   0x401198 &lt;flag_1&gt;
</span></span><span class=line><span class=cl>=&gt; 0x0000000000401172 &lt;+28&gt;:    movzx  eax,BYTE PTR [rip+0x2ea7]        # 0x404020 &lt;a&gt;
</span></span><span class=line><span class=cl>   0x0000000000401179 &lt;+35&gt;:    test   al,al
</span></span><span class=line><span class=cl>   0x000000000040117b &lt;+37&gt;:    jne    0x401182 &lt;main+44&gt;
</span></span><span class=line><span class=cl>   0x000000000040117d &lt;+39&gt;:    call   0x401211 &lt;flag_2&gt;
</span></span><span class=line><span class=cl>   0x0000000000401182 &lt;+44&gt;:    lea    rax,[rip+0xea7]        # 0x402030
</span></span><span class=line><span class=cl>   0x0000000000401189 &lt;+51&gt;:    mov    rdi,rax
</span></span><span class=line><span class=cl>   0x000000000040118c &lt;+54&gt;:    call   0x401050 &lt;puts@plt&gt;
</span></span><span class=line><span class=cl>   0x0000000000401191 &lt;+59&gt;:    mov    eax,0x0
</span></span><span class=line><span class=cl>   0x0000000000401196 &lt;+64&gt;:    pop    rbp
</span></span><span class=line><span class=cl>   0x0000000000401197 &lt;+65&gt;:    ret
</span></span><span class=line><span class=cl>End of assembler dump.
</span></span></code></pre></td></tr></table></div></div><p>디스어셈블을 보면 <code>test</code> 명령어를 통해 <code>al</code> 레지스터가 0인 경우에만 실행되는 것을 알 수 있는데, 해당 명령어 실행 직전에 <code>set $al = 0</code> 명령어를 통해 <code>al</code> 레지스터의 값을 0으로 변경해주면 <code>flag_2</code> 함수가 실행되어 플래그를 확인할 수 있다.</p><p><img src=/p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/image-1.png width=1920 height=1080 srcset="/p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/image-1_hu_55592b6763bf569b.png 480w, /p/layer7-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%95%B4%ED%82%B9-1%EC%B0%A8%EC%8B%9C/image-1_hu_d29f2011f75362a1.png 1024w" loading=lazy class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><hr><h3 id=pwntools>pwntools</h3><p>pwntools는 pwnable 분야의 CTF 문제를 푸는 데 도움을 주는 프레임워크이다.</p><p>파이썬에서 사용할 수 있다.</p><hr><h4 id=함수-종류>함수 종류</h4><ul><li><code>process()</code> : 로컬 바이너리 연결</li><li><code>remote()</code> : 원격 서버 연결</li><li><code>send()</code> : 데이터 송신</li><li><code>recv()</code> : 데이터 수신</li><li><code>close()</code> : 연결 종료</li></ul><p>이 외에도 다양한 함수가 존재한다.</p><hr><h4 id=addition-quiz>addition-quiz</h4><p>파이썬으로 주어진 문제를 파싱하여 더한 값을 전송하는 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># io = process(&#39;./chall&#39;)</span>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;host8.dreamhack.games&#39;</span><span class=p>,</span> <span class=mi>15434</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>q</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;+&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>y</span><span class=p>[:</span><span class=o>-</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>+</span> <span class=nb>int</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><hr><h4 id=flag-shop>flag-shop</h4><p>파이썬으로 flag에 해당하는 번호를 전송하도록 코드를 작성하였다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;host8.dreamhack.games&#34;</span><span class=p>,</span> <span class=mi>16567</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>items</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;. &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>fruit</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>items</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;flag&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=n>num</span> <span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&gt; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>io</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>io</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/layer7/>Layer7</a>
<a href=/tags/system-hacking/>System Hacking</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/layer7-web-hacking-mini-ctf-write-up/><div class=article-details><h2 class=article-title>Layer7 Web Hacking mini CTF | Write-up</h2></div></a></article><article><a href=/p/layer7-reversing-mini-ctf-write-up/><div class=article-details><h2 class=article-title>Layer7 Reversing mini CTF | Write-up</h2></div></a></article><article><a href=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-8%EC%B0%A8%EC%8B%9C/><div class=article-details><h2 class=article-title>Layer7 리버싱 8차시</h2></div></a></article><article><a href=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-7%EC%B0%A8%EC%8B%9C/><div class=article-details><h2 class=article-title>Layer7 리버싱 7차시</h2></div></a></article><article><a href=/p/layer7-%EB%A6%AC%EB%B2%84%EC%8B%B1-6%EC%B0%A8%EC%8B%9C/><div class=article-details><h2 class=article-title>Layer7 리버싱 6차시</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 T43W00</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>